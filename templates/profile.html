{% extends "base.html" %}
{% block title %}Profile{% endblock %}

{% block content %}
<div class="profile-page">
  <div class="profile-panel container-lg">

    <!-- LEFT SIDEBAR -->
    <aside class="profile-sidebar">
      <div class="profile-top text-center">
        <img id="avatarPreview" src="{{ avatar_url }}" class="avatar-img">
        <h5 class="mt-3">{{ user.username }}</h5>
      </div>

      <nav class="profile-nav">
        <a class="active">Account</a>
        <a>Membership</a>
        <a>Contact</a>
        <a>Billing</a>
        <a>Refer Friends</a>
      </nav>
    </aside>

    <!-- RIGHT PANEL -->
    <section class="profile-content">

      <!-- Account -->
      <div class="card settings-card mb-4">
        <h4>Account</h4>
        <form method="post" enctype="multipart/form-data">
          <input type="hidden" name="form-type" value="profile">

          <label class="mt-2">Username</label>
          <input name="username" class="form-control" value="{{ user.username }}">

          <label class="mt-3">Email</label>
          <input name="email" class="form-control" value="{{ user.email }}">

          <label class="mt-3">Profile Picture</label>
          <input type="file" id="avatarFile" name="avatar" accept="image/*" class="form-control">

          <button class="btn btn-primary mt-3">Save Change</button>
        </form>
      </div>

      <!-- PASSWORD -->
      <div class="card settings-card">
        <h4>Your Password</h4>
        <form method="post">
          <input type="hidden" name="form-type" value="password">

          <label class="mt-2">Current Password</label>
          <input name="current_password" type="password" class="form-control">

          <label class="mt-3">New Password</label>
          <input name="new_password" type="password" class="form-control">

          <label class="mt-3">Confirm New Password</label>
          <input name="confirm_password" type="password" class="form-control">

          <button class="btn btn-outline-primary mt-3">Update Password</button>
        </form>
      </div>

    </section>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("avatarFile")?.addEventListener("change", function(){
  const file = this.files[0];
  if (!file) return;
  document.getElementById("avatarPreview").src = URL.createObjectURL(file);
});
</script>
{% endblock %}
